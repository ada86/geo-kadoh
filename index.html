<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script type="text/javascript" src="utils/jquery.js"></script>
	<script src="bootstrap/js/bootstrap.js"></script>
	<script src="http://maps.google.com/maps/api/js?sensor=true"></script>
	<script type="text/javascript" src="KadOH.js?debug=true"></script>
	<script type="text/javascript" src="lib/checkIn.js"></script>
	<script type="text/javascript" src="utils/sha1.js"></script>
	<script type="text/javascript" src="utils/cryptico.js"></script>
	<script type="text/javascript" src="utils/sjcl.js"></script>
	<script type="text/javascript" src="lib/configManager.js"></script>
	<script type="text/javascript" src="lib/listManager.js"></script>
	<script type="text/javascript" src="lib/checkIn.js"></script>
	<script type="text/javascript" src="lib/posUtils.js"></script>
	<script type="text/javascript" src="lib/htmlEvents.js"></script>
	<script type="text/javascript" src="lib/kadohInit.js"></script>

	<script type="text/javascript">
	
		var text = "Please login :)";
		function log(txt){
			text = txt+"<br>".concat(text);
			document.getElementById("output").innerHTML=text;
			document.getElementById("outputMobile").innerHTML=text;
		}
	</script>
	<link href="bootstrap/css/bootstrap.css" rel="stylesheet" media="screen">
	<link href="bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
	<title>Geo-KadOH</title>
</head>
<body>
	<!--
	**** Navigation bar ***********************************************************************************
	*******************************************************************************************************
	*******************************************************************************************************
	-->
	<div class="navbar navbar-static-top">
		<div class="navbar-inner">
			<div class="container-fluid">
				<a class="btn btn-navbar" data-toggle="collapse" data-target="nav-collapse">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</a>
				<a class="brand">Geo-KadOH</a>
				<div class="nav-collapse collapse">
					<p id="loggedIn" class="navbar-text pull-right">
					</p>
					<ul id="info" class="nav">
						<li><button class="btn btn-success" href="#Login" data-toggle="modal"> Log in</button></li>
					</ul>
					<ul class="nav">
						<li><a href="#Guide" data-toggle="modal">Guide</a></li>
						<li class="divider-vertical"></li>
						<li><a href="https://github.com/ada86/geo-kadoh">Source</a></li>
						<li><a href="https://github.com/ada86/geo-kadoh/blob/master/README.md">Documentation</a></li>
					</ul>
				</div>
			</div>
		</div>
	</div>


	<!--
	**** Modals *******************************************************************************************
	*******************************************************************************************************
	*******************************************************************************************************
	-->
		<!--Login-->
	<div id="Login" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="false">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			<h3 id="myModalLabel">Log in</h3>
			<p class="text-info">If you don't have an account, we'll create it for you. Just enter the desired username and password.</p>
		</div>
		<form class="modal-form">
			<div class="modal-body">
				<input id="myName" type="text" class="input-block-level" placeholder="Username"  required>
				<input id="password" type="password" class="input-block-level" placeholder="Password"  required>
				<label class="checkbox">
					<input id="remember-me" type="checkbox" name="remember-me">Remember my configuration on this machine</input>
				</label>
			</div>
			<div class="modal-footer">
				<button class="btn btn-large btn-primary" data-dismiss="modal" aria-hidden="true" onClick="configManager.logIn()">Log in</button>
			</div>
		</form>
	</div>
		<!--Guide-->
	<div id="Guide" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2" aria-hidden="true">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			<h3 id="myModalLabel2">Guide for using Geo-KadOH</h3>
		</div>
		<div class="modal-body pagination-centered">
			<img height="80" width="83" src="bootstrap/img/Geo-KadOH_logo.png">
			<p class="lead">Geo-KadOH is a decentralized solution for location sharing. You can easily create an account and start sharing your location with your friends.</p>
			<h4>About log in</h4>
			<p>If you don't have an account just type any username and password, and the system will create for you an account.</p>
			<h4>Output box</h4>
			<p>This box tells you in what state the website is. It also gives you responses on whether thigs go well or not.</p>
			<h4>Locating yourself</h4>
			<p>To locate yourself and share it to your friends just push the Share my location button. Your browser may ask you to allow location sharing which is required for this functionality. Succesfully shared location will be announced in the output box and your location will shown in the map. If you wish to share only with your group members then click on the small arrow and select the group you want to share with.</p>
			<h4>Finding friends and groups</h4>
			<p>Just type your friends username and we'll see if he has shared his location. There is a list of your saved friends behind the arrow. You can modify the list with edit button. After you have selected a friend we'll show you in the output box if the friends location was found. The friend will be then shown in the map. There is also a possibility</p>
			<h4>Requirement</h4>
			<p>You can use both desktop and mobile devices to use Geo-KadOH. Only requirement is that the browser or the device should support HTML5.</p>
			<h4>Contact us</h4>
			<p>If you have some feedback on the webpage, we'll be happy to hear it. Just <a href="mailto:abdalla.taha@eurecom.fr,lorenzo.rande@eurecom.fr">click here</a></p>
		</div>
		<div class="modal-footer">
			<button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
		</div>
	</div>
		<!--Edit Friend-->
	<div id="editFriends" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel3" aria-hidden="true">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			<h3 id="myModalLabel3">Edit friend list</h3>
		</div>
		<div class="modal-body" >
			<p id="friendListModal">List empty</p>
			<hr>
			<h4>Add friend</h4>
			<div class="modal-form form-inline">
				<input id="addFriendName" type="text" class="input-small" placeholder="Username" required>
				<input id="addFriendKey" type="text" class="input-small" placeholder="Key">
				<button class="btn" onClick="listManager.addFriend()"><i class="icon-user"></i><i class="icon-plus"></i>Add</button>
			</div>
		</div>
		<div class="modal-footer">
			<button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
		</div>
	</div>
		<!--Edit Group-->
	<div id="editGroups" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel4" aria-hidden="true">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			<h3 id="myModalLabel4">Edit Group list</h3>
		</div>
		<!--Groupid can be anything, also groupname if it's better they just need to be in sync with above <ul> section-->
		<div class="modal-body tabbable" id="#groupMenu3">
			<ul class="nav nav-tabs">
				<li class="active"><a href="#Group1" data-toggle="tab">Friends</a></li>
				<li><a href="#Group2" data-toggle="tab">Work mates</a></li>
				<li><a href="#Group3" data-toggle="tab">Family</a></li>
			</ul>
			<div class="tab-content">
				<div class="tab-pane active" id="Group1">
					<li><p><i class="icon-user"></i> Lorenzo<button class="btn btn-link" onClick="listManager.removeFriendGroup('Group1','Lorenzo');"><i class="icon-trash"></i></button></p></li>
					<li><p><i class="icon-user"></i> Abdalla<button class="btn btn-link" onClick="listManager.removeFriendGroup('Group1','Abdalla');"><i class="icon-trash"></i></button></p></li>
				</div>
				<div class="tab-pane" id="Group2">
					<li><p><i class="icon-user"></i> Tudor<button class="btn btn-link" onClick="listManager.removeFriendGroup('Group2','Tudor');"><i class="icon-trash"></i></button></p></li>
					<li><p><i class="icon-user"></i> Marc<button class="btn btn-link" onClick="listManager.removeFriendGroup('Group2','Marc');"><i class="icon-trash"></i></button></p></li>
				</div>
				<div class="tab-pane" id="Group3">
					<li><p><i class="icon-user"></i> Mom<button class="btn btn-link" onClick="listManager.removeFriendGroup('Group3','Mom');"><i class="icon-trash"></i></button></p></li>
					<li><p><i class="icon-user"></i> Dad<button class="btn btn-link" onClick="listManager.removeFriendGroup('Group4','Dad');"><i class="icon-trash"></i></button></p></li>
				</div>
			</div>
		</div>
		<div class="modal-body">
			<hr>
			<h4>Add a new group</h4>
			<div class="modal-form form-inline">
				<input type="text" class="input-small" placeholder="Groupname" id="addGroupName" required>
				<input type="text" class="input-small" placeholder="Key" id="addGroupKey">
				<button class="btn" onClick="listManager.addGroup()"><i class="icon-th-list"></i><i class="icon-plus"></i>Add</button>
			</div>
			<hr>
			<h4>Add a member to a group</h4><!--maybe put here a list of the friend list and group list so user can only add existing friends in existing group-->
			<div class="modal-form form-inline">
				<input type="text" class="input-small" placeholder="Groupname" id="addGroupName2" required>
				<input type="text" class="input-small" placeholder="Username" id="addGroupUser">
				<button class="btn" onClick="listManager.addFriendGroup()"><i class="icon-user"></i><i class="icon-plus"></i>Add</button>
			</div>
		</div>
		<div class="modal-footer">
			<button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
		</div>
	</div>
	

	<!--
	**** Main body Mobile *********************************************************************************
	**** This part is only visible to mobile devices ******************************************************
	*******************************************************************************************************
	-->
	<div class="container pagination-centered visible-phone hidden-desktop">
		<!--Topic-->
		<div class="page-header">
			<div id="welcomeMobile">
				<img height="80" width="83"src="bootstrap/img/Geo-KadOH_logo.png">
				<h1>Welcome to Geo-KadOH<br>
					<small>The decentralized location sharing Web application</small>
				</h1>
			</div>
			<h4 id="loggedInMobile"><button class="btn btn-success" href="#Login"  data-toggle="modal"> Log in</button></h4>
		</div>
		<!--Map-->
		<div class="row-fluid collapse in">
			<div class="span7 offset1" id="mapholderMobile"></div>
		</div>
		<div class="row-fluid">
			<!--Share my location-->
			<div class="span4" id="shareMyLocationMobile">
				<h2>Share my location</h2>
				<br>
				<button class="btn btn-primary" onClick="checkIn.putMyLocation(true)"><i class="icon-ok-circle icon-white"></i> To friends</button>
				<button class="btn btn-primary" onClick="checkIn.putMyLocation(false)"><i class="icon-globe icon-white"></i> To public</button>
				<button class="btn btn-primary" data-toggle="collapse" data-target="#ShareToGroupMobile"><i class="icon-th-list icon-white"></i> To group</button>
				<div id="ShareToGroupMobile" class="collapse">
					<p align="center" class="text-error">List empty</p>
				</div>
				<br><br><br>
			</div>
			<!--Find Friends and Group-->
			<div class"span4">
				<h2>Find friends</h2><br>
				<div class="form-search">
					<input id="findMobile" type="text" placeholder="Username" onkeydown="if (event.keyCode == 13) checkIn.getFriendLocation(undefined, 'mobile')">
					<button id="btnFindMobile" class="btn btn-primary" onClick="checkIn.getFriendLocation(undefined, mobile)"><i class="icon-search icon-white"></i> Find</button>
				</div><br>
				<button class="btn btn-primary" data-toggle="collapse" data-target="#friendListMobile"><i class"icon-user icon-white"></i> Friend list</button>
				<div id="friendListMobile" class="collapse">
					<p align="center" class="text-error">List empty</p>
					<p><a href="#editFriends"role="button" data-toggle="modal"><i class="icon-pencil"></i> Edit</a></p>
				</div><br>
				<h2>Find group</h2><br>
				<button class="btn btn-primary" data-toggle="collapse" data-target="#groupListMobile"><i class"icon-search icon-white"></i> Find Group</button>
				<div id="groupListMobile" class="collapse">
					<p class="text-error">List empty</p>
					<p><a href="#editGroups" role="button" data-toggle="modal"><i class="icon-pencil"></i> Edit</a></p>
				</div>
				<br><br>
			</div>
			<!--Output-->
			<div class="span4">
				<h2>Output</h2>
				<br>
				<pre id="outputMobile" class="pre pre-scrollable" style="height: 6pc;">Trying to connect to the DHT</pre><br>
			</div>
		</div>
	</div>


	<!--
	**** Main body Desktop ********************************************************************************
	**** This part is only visible to desktop devices *****************************************************
	*******************************************************************************************************
	-->
	<div class="container pagination-centered hidden-phone visible-desktop">
		<!--Topic-->
		<div id="welcome">
			<div class="hero-unit ">
				<h1>Welcome to Geo-KadOH<img height="133" width="135"src="bootstrap/img/Geo-KadOH_logo.png"></h1>
				<p>The decentralized location sharing Web application</p>
			</div>
		</div>
		<!--Map-->
		<div class="row-fluid collapse in">
			<div id="mapholder" class="span10 offset1"></div>
		</div>
		<div class="row-fluid">
		<!--Share my location-->
			<div class="span4" id="shareMyLocation">
				<h2>Share my location</h2>
				<br>
				<div class="btn-group">
					<button class="btn btn-primary" onClick="checkIn.putMyLocation(true)"><i class="icon-ok-circle icon-white"></i> To friends</button>
					<button class="btn btn-primary" onClick="checkIn.putMyLocation(false)"><i class="icon-globe icon-white"></i> To public</button>
					<button class="btn btn-primary dropdown-toggle" data-toggle="dropdown"><i class="icon-th-list icon-white"></i> To group <span class="caret"></span></button>
					<ul id="shareToGroup" class="dropdown-menu pull-right">
						<li class="text-info">Only to group:</li>
						<li class="text-error">List empty</li>
					</ul>
				</div>
				<br><br><br>
			</div>
		<!--Find Friends and Group-->
			<div class="span4">
				<h2>Find friends</h2><br>
				<div class="form-search">
					<input id="find" class="span6" type="text" placeholder="Username" onkeydown="if (event.keyCode == 13) checkIn.getFriendLocation(undefined, 'desktop')">
					<div class="btn-group">
						<button id="btnFind" class="btn btn-primary" onClick="checkIn.getFriendLocation(undefined, 'desktop')"><i class="icon-search icon-white"></i> Find</button>
						<button class="btn btn-primary dropdown-toggle" data-toggle="dropdown">Friend list
							<span class="caret"></span>
						</button>
						<ul id="friendList" class="dropdown-menu" align="left">
							<li align="center" class="text-error">List empty</li>
							<li><a href="#editFriends"role="button" data-toggle="modal"><i class="icon-pencil"></i> Edit</a></li>
						</ul>
					</div><br>
				</div>
				<h2>Find group</h2><br>
				<div class="btn-group">
					<button class="btn btn-primary dropdown-toggle" data-toggle="dropdown"><i class="icon-search icon-white"></i> Group list <span class="caret"></span>
					</button>
					<ul id="groupMenu2" class="dropdown-menu" align="left">
						<li align="center" class="text-error">List empty</li>
						<li><a href="#editGroups"role="button" data-toggle="modal"><i class="icon-pencil"></i> Edit</a></li>
					</ul>
				</div><br><br>
			</div>
		<!--Output-->
			<div class="span4">
				<h2>Output</h2>
				<br>
				<pre id="output" class="pre pre-scrollable" style="height: 10pc;">Trying to connect to the DHT</pre><br>
			</div>
		</div>
	</div>


	<!--
	**** Footer *******************************************************************************************
	*******************************************************************************************************
	*******************************************************************************************************
	-->
	<hr>
	<div>
		<div class="container">
			<p class="muted credit"><strong>Abdalla Taha</strong> and <strong>Lorenzo Rand&eacute</strong></p>
		</div>
	</div>  
</body>
</html>
